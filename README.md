# Синхронний REST-клієнт з підтримкою системи Трембіта

REST-клієнт, описаний в даній інструкції, розроблений мовою програмування Python з використанням фреймворку FastAPI і є сумісним з системою «Трембіта».

Даний клієнт передбачає отримання відомостей про інформаційні об’єкти (користувачів) та управління їх статусом, у тому числі відправку запитів на пошук, отримання, створення, редагування та видалення об’єктів до відповідного сервісу. 

Додатково передбачено функції завантаження архівів з підписаними електронними повідомленнями-запитами, повідомленнями-відповідями у вигляді ASiC-контейнерів, а також генерацію ключів і сертифікатів для взаємної автентифікації між REST-клієнтом та ШБО системи «Трембіта».

## Вимоги до програмного забезпечення 
| ПЗ            |   Версія   | Примітка                                                                                                                                                                                               |
|:--------------|:----------:|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Ubuntu Server |   24.04    | Рекомендовані характеристики віртуальної машини:<br/> CPU: 1 <br/> RAM: 512 Мб                                                                                                                         |
| Python        | **3.10!**  | За допомогою скрипта встановлюється автоматично.<br/> Також можна встановити вручну при виборі відповідного типу інсталяції.<br/>**Важливо!** Якщо версія Python нижче 3.10, сервіс працювати не буде. |
| Git           |            | Для клонування репозиторію                                                                                                                                                                             |

## Залежності

Залежності зазначені в файлі requirements.txt.
  
## Структура проєкту

Структура проєкту виглядає наступним чином:

```
web-client_trembita_sync/
├── Dockerfile
├── LICENSE
├── README.Docker.md
├── README.md
├── app.py
├── asic
├── certs
│    ├── cert.pem
│    └── key.pem
├── compose.yaml
├── config.ini
├── deploy.sh
├── docs
│    ├── docker_installation.md
│    ├── manual_installation.md
│    └── script_installation.md
├── remove.sh
├── requirements.txt
├── templates
│    ├── create_person.html
│    ├── error.html
│    ├── list_certs.html
│    ├── list_files.html
│    ├── list_files_run_aawy.html
│    ├── list_person.html
│    ├── navbar.html
│    ├── search_form.html
│    └── user_form.html
└── utils.py
```
## Інсталяція клієнту

Клієнт можна інсталювати за допомогою скрипта автоматичного встановлення або вручну. Також клієнт може працювати в Docker

- [Інсталяція клієнту за допомогою скрипта автоматичного встановлення](./docs/script_installation.md).
- [Інсталяція сервісу вручну](./docs/manual_installation.md).
- [Конфігурація сервісу](./docs/configuration.md).
- [Pозгортання вебсервісу в Docker ](./docs/docker_installation.md).

## Адміністрування сервісу

### Запуск вебклієнту, встановленого за допомогою скрипта

Після того, як вебклієнт було встановлено за допомогою скрипта, необхідно запустити його за допомогою команди:

```bash
sudo systemctl start flask-app
```

### Запуск вебклієнту, встановленого вручну

Після того, як вебсервіс було встановлено вручну, а налаштування були завершені, необхідно запустити його:
```bash
export FLASK_APP=app.py
export FLASK_ENV=development
flask run --host=0.0.0.0
```

### Перевірка статусу вебклієнту

Для того, щоб перевірити статус вебклієнту, **встановленого за допомогою скрипта**, необхідно виконати наступну команду:

```bash
sudo systemctl status flask-app
```
В разі, коли вебклієнт встановлено вручну, дана можливість не забезпечується.


### Зупинка вебклієнту

Для зупинки роботи вебсервісу, **встановленого за допомогою скрипта**, необхідно виконати наступну команду:
```bash
sudo systemctl stop flask-app
```

В разі, коли вебклієнт встановлено вручну, дана можливість не забезпечується.


### Видалення вебклієнту

Для видалення вебклієнту та всіх пов'язаних компонентів було створено скрипт `remove.sh`.

**Важливо!** Скрипт працює виключно у випадку якщо вебклієнт було розгорнуто за допомогою скрипту автоматичного встановлення.

Даний скрипт після запуску, зупинить та видалить вебклієнт, видалить віртуальне середовище, клонований репозиторій та системні залежності.

Для того, щоб запустити скрипт необхідно:

1. Зробити файл виконуваним:

   ```bash
   chmod +x remove.sh
   ```

2. Запустити скрипт:

   ```bash
   ./remove.sh
   ```

Для видалення вебклієнту, **встановленого вручну** достатньо видалити його директорію.

### Перегляд журналу подій

За замовчуванням журнал подій зберігається у файлі `client.log`.

Конфігурація параметрів журналювання подій виконується в файлі `config.ini`. Детальніше з параметрами журналювання в даному файлі можна ознайомитися в настановах з [конфігурування](./docs/configuration.md).

## Використання вебклієнту

Для доступу до вебінтерфейсу розробленого вебклієнту необхідно перейти за посиланням:
```
http://<your_server_ip>:5000
```

В даному інтерфейсі можна виконати наступні дії:
1.	Шукати записи в БД за певними параметрами.
2.	Створювати записи в БД.
3.	Модифікувати записи в БД 
**Важливо!** Обмеження сервісу – не можна міняти поле unzr!
4.	Видаляти записи в БД за УНЗР.
5.	В разі, якщо для зв’язку з ШБО системи «Трембіта» використовується HTTPS, буде доступна можливість завантажувати ASIC-контейнери з запитами від вебклієнта до вебсервісу, які були передані через даний ШБО.
6.	Завантажити сертифікат даного вебклієнту для взаємної автентифікації з ШБО. Дану дію можна виконати на вкладці «Сертифікати».


## Внесок

Якщо ви хочете зробити свій внесок у проєкт, будь ласка, створіть форк репозиторію і відправте Pull Request.

## Ліцензія

Цей проект ліцензується відповідно до умов MIT License.

##
Матеріали створено за підтримки проєкту міжнародної технічної допомоги «Підтримка ЄС цифрової трансформації України (DT4UA)».
